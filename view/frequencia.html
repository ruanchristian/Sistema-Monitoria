<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chamada</title>
    <!-- Bootstrap CSS and JS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-OERcA2EqjJCMA+/3y+gxIOqMEjwtxJY7qPCqsdltbNJuaOe923+mo//f6V8Qbsw3" crossorigin="anonymous"></script>

    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.1.js" integrity="sha256-3zlB5s2uwoUzrXK3BT7AX3FyvojsraNFxCc2vC/7pNI=" crossorigin="anonymous"></script>

    <!-- My Custom CSS and JS file -->
    <link rel="stylesheet" href="/Sistema Monitoria/assets/styles/styles.css">
    <link rel="stylesheet" href="/Sistema Monitoria/assets/styles/chamada.css">
    <script src="/Sistema Monitoria/assets/js/frames.js"></script>

    <link rel="icon" href="/Sistema Monitoria/assets/img/infortec2b-icon.png">

    <!-- Font Awesome LIB -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css"
        integrity="sha512-xh6O/CkQoPOWDdYTDqeRdPCVd1SpvCA9XXcUnZS2FmJNp1coAFzvtCN9BmamE+4aHK8yyUHUSCcJHgXloTyT2A=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/js/fontawesome.min.js"
        integrity="sha512-j3gF1rYV2kvAKJ0Jo5CdgLgSYS7QYmBVVUjduXdoeBkc4NFV4aSRTi+Rodkiy9ht7ZYEwF+s09S43Z1Y+ujUkA=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
</head>

<body class="sb-nav-fixed">

    {% include 'template-menu.html' %}

    <div id="layoutSidenav_content">
        <main>
            <div class="container-fluid px-4">
                <div class="text-center mt-4">
                    <i id="iconCheck" class="fas fa-check"></i>
                    <h5 class="d-inline text-decoration-underline">Frequência - Chamada</h5>
                    <form method="POST" action="frequencia/search">
                        <div class="container mt-4">
                            <div class="row mb-3 mt-2 mx-auto">
                                <div class="col-md mb-2">
                                    <div class="form-floating">
                                        <input disabled type="date" value="{{date}}" class="form-control" id="dateField">
                                        <label for="floatingInputGrid">Data:</label>
                                    </div>
                                </div>
                                <div class="col-md">
                                    <div class="form-floating">
                                        <select name="frequenciaSelect" class="form-select text-truncate" id="selectTurma">
                                            <optgroup label="1º Séries">
                                                <option selected value="1º A - Administração">1° A - ADMINISTRAÇÃO</option>
                                                <option value="1º B - Edificações">1° B - EDIFICAÇÕES</option>
                                                <option value="1º C - Informática">1° C - INFORMÁTICA</option>
                                                <option value="1º D - Nutrição">1° D - NUTRIÇÃO</option>
                                            </optgroup>
                                            <optgroup label="2º Séries">
                                                <option value="2º A - Edificações">2° A - EDIFICAÇÕES</option>
                                                <option value="2º B - Informática">2° B - INFORMÁTICA</option>
                                                <option value="2º C - Logistíca">2° C - LOGÍSTICA</option>
                                                <option value="2º D - Nutrição">2° D - NUTRIÇÃO</option>
                                            </optgroup>
                                        </select>
                                        <label for="selectTurma">Selecione a turma:</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <button id="btnSearchCurrent" type="submit" class="btn btn-dark">
                            <i class="fas fa-search"></i>
                            Buscar Alunos
                        </button>
                </div>
                </form>
            
                {% if alunos %}
                <hr>
                <form method="POST" action="frequencia/write">
                <div class="cardAlunos card w-75 mx-auto d-block">
                    <div class="card-body">
                        <h3>Lista de alunos <h6>({{alunos['list'][0]['turma']}})</h6></h3>
                        <hr>
                        <p class="card-text">
                            {% for aluno in alunos['list'] %}
                            {% if img %}
                             <img width="15%" class="img-fluid img-thumbnail" src="{{img[loop.index0]}}">
                             {% else %}
                             <i class="fas fa-user"></i>
                             {% endif %}
                              <span class="d-inline user-select-none"> {{aluno['nome']}} - </span>
                              <small> ({{aluno['matricula']}})</small><br>
                              <label class='switch mt-4'><input value="{{aluno['id']}}" onchange="changeState(this, `{{aluno['id']}}`)" name="check[]" type='checkbox'><span></span></label>
                              <span id="{{aluno['id']}}" class="float-end">P</span>
                              <hr>
                            {% endfor %}
                        </p>
                        <button class="sendAll btn btn-success bg-gradient mx-auto d-block">
                            <i class="fas fa-upload"></i>
                            Enviar frequência
                        </button>
                    </div>
                </div>
            </form>
                
                {% elseif error %} 
 
                <div class="row">
                <div class="alert alert-danger alert-dismissible fade show bg-danger bg-gradient col-md-4 col-md-offset-4 mx-auto mt-4 text-white" role="alert">
                    {{error['msg']}}
                    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                  </div>
                </div>

                {% endif %}

                {% if success %}
                <div class="row">
                    <div class="alert alert-success alert-dismissible fade show bg-success bg-gradient col-md-4 col-md-offset-4 mx-auto mt-4 text-white" role="alert">
                        {{success['msg']}}
                        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                      </div>
                    </div>
                {% endif %}
            
                <div id="modalSpin" class="modal fade" data-bs-keyboard="false" data-bs-backdrop="static" tabindex="-1">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="modalLabel">Carregando lista...</h5>
                            </div>
                            <div class="modal-body mx-auto d-block">
                                <div class="d-flex justify-content-center">
                                    <div style="width: 3rem; height: 3rem;" class="spinner-border">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
        <div id="modalSpin" class="modal fade" data-bs-keyboard="false" data-bs-backdrop="static" tabindex="-1">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="modalLabel">Baixando em pdf...</h5>
                    </div>
                    <div class="modal-body mx-auto d-block">
                        <div class="d-flex justify-content-center">
                            <div style="width: 3rem; height: 3rem;" class="spinner-border"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <footer class="py-4 bg-light mt-auto">
            <div class="container-fluid px-4">
                <div class="d-flex align-items-center justify-content-between small">
                    <div class="text-muted">Created by &copy; <strong>
                            <a class="text-decoration-none" target="_blank"
                                href="https://www.instagram.com/ruanchristian7/">Ruan Christian</a>
                        </strong>
                        <script>
                            document.write(new Date().getFullYear());
                        </script>
                    </div>
                </div>
            </div>
        </footer>
    </div>
    </body>
</html>